(()=>{var e;(e=jQuery)(document).ready((function(){"use strict";e(".bp-tabs .tab__link").on("click",(function(t){t.preventDefault(),e(".bp-tabs .tab__link").removeClass("active"),e(this).addClass("active");var a=e(this).data("id");e(".bp-tabs .tab__content__item").removeClass("show").fadeOut(),e("#"+a).addClass("show").fadeIn()})),e(document).on("click",".sidebar__menu a",(function(t){t.preventDefault();let a="sidebar__link";e(this).hasClass("sidebar__link_submenu")&&(a="sidebar__link_submenu"),e(".sidebar__menu ."+a).removeClass("active"),e(this).addClass("active");var n=e(this).data("id");e(".content__area__body .sidebar__tab__content").removeClass("show").fadeOut(),e("#"+n).addClass("show").fadeIn(),!e(this).hasClass("sidebar__link")||"admin-email"!==n&&"paypal"!==n||(e(this).siblings("ul").find("li a").removeClass("active"),e(this).siblings("ul").find("li:first-child a").addClass("active"))})),e(document).on("click",".sidebar__item .sidebar__link, .email-additional-headers",(function(t){t.preventDefault();let a=e(this),n=e(this).hasClass("email-additional-headers")?".email-additional-headers-content":".sub__menu";a.siblings(n).hasClass("show")?a.siblings(n).removeClass("show").slideUp():(e(n+".show").slideUp().removeClass("show"),a.siblings(n).addClass("show").slideDown())})),e(document).on("change",'.better-payment-settings-payment-paypal input[name="better_payment_settings_payment_paypal_live_mode"]',(function(t){t.preventDefault();let a=e(this).attr("data-targettest");e(this).is(":checked")&&(a=e(this).attr("data-targetlive")),e(".bp-paypal-key").removeClass("bp-d-block").addClass("bp-d-none"),e(`.${a}`).removeClass("bp-d-none").addClass("bp-d-block")})),e(document).on("change",'.better-payment-settings-payment-stripe input[name="better_payment_settings_payment_stripe_live_mode"]',(function(t){t.preventDefault();let a=e(this).attr("data-targettest");e(this).is(":checked")&&(a=e(this).attr("data-targetlive")),e(".bp-stripe-key").removeClass("bp-d-block").addClass("bp-d-none"),e(`.${a}`).removeClass("bp-d-none").addClass("bp-d-block")})),e(document).on("change",'.better-payment-settings-payment-paystack input[name="better_payment_settings_payment_paystack_live_mode"]',(function(t){t.preventDefault();let a=e(this).attr("data-targettest");e(this).is(":checked")&&(a=e(this).attr("data-targetlive")),e(".bp-paystack-key").removeClass("bp-d-block").addClass("bp-d-none"),e(`.${a}`).removeClass("bp-d-none").addClass("bp-d-block")})),e(document).on("click",".better-payment-admin-settings-button",(function(t){t.preventDefault(),function(t,a){let n=e(t),s=betterPaymentObj.nonce,o=e(a).serializeArray(),r=function(t,a=[]){e("#better-payment-admin-settings-form input").removeClass("is-danger"),a.length||(a=["better_payment_settings_general_email_to","better_payment_settings_general_email_from_email","better_payment_settings_general_email_reply_to","better_payment_settings_general_email_cc","better_payment_settings_general_email_bcc","better_payment_settings_general_email_to_customer","better_payment_settings_general_email_from_email_customer","better_payment_settings_general_email_reply_to_customer","better_payment_settings_general_email_cc_customer","better_payment_settings_general_email_bcc_customer","better_payment_settings_payment_paypal_email"]);let n="",s="",o="",r=!1,i="";for(const l in t)if(o=t[l],n=o.name,s=o.value,a.indexOf(n)>=0&&""!=s&&(r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s),!r))return"better_payment_settings_general_email_to"==n?i="Admin Email: To Email":"better_payment_settings_general_email_from_email"==n?i="Admin Email: From Email":"better_payment_settings_general_email_reply_to"==n?i="Admin Email: Reply-To":"better_payment_settings_general_email_cc"==n?i="Admin Email: Cc":"better_payment_settings_general_email_bcc"==n&&(i="Admin Email: Bcc"),"better_payment_settings_general_email_to_customer"==n?i="Customer Email: To Email":"better_payment_settings_general_email_from_email_customer"==n?i="Customer Email: From Email":"better_payment_settings_general_email_reply_to_customer"==n?i="Customer Email: Reply-To":"better_payment_settings_general_email_cc_customer"==n?i="Customer Email: Cc":"better_payment_settings_general_email_bcc_customer"==n?i="Customer Email: Bcc":"better_payment_settings_payment_paypal_email"==n&&(i="PayPal Business Email"),toastr.error(`Invalid email address on ${i} field!`),e(`#better-payment-admin-settings-form input[name="${n}"]`).addClass("is-danger"),!1;return!0}(o);if(e(".better-payment-settings-reset").val(0),e(t).hasClass("better-payment-reset-button")&&e(".better-payment-settings-reset").val(1),!r)return!1;let i=e(t).hasClass("better-payment-reset-button");e.ajax({type:"POST",url:ajaxurl,data:{action:"better_payment_settings_action",nonce:s,form_data:o,reset_button:i},beforeSend:function(){n.addClass("is-loading")},success:function(e){n.removeClass("is-loading"),"success"===e.data?toastr.success("Changes saved successfully!"):toastr.error("Opps! something went wrong!")}})}(this,e("#better-payment-admin-settings-form"))})),e(document).on("change",".better-payment .header__show_entries select, .better-payment .showing-entities-html select",(function(t){t.preventDefault();let a=e(this).val();location=location.origin+location.pathname+location.search+"&paged=1&per_page="+a+location.hash})),e(document).on("click",".better-payment-transaction-edit, .better-payment-transaction-email-resend",(function(e){e.preventDefault(),toastr.warning("Coming REAL Soon!")})),e(document).on("click",".better-payment-transaction-reset",(function(e){e.preventDefault();let t=window.location.href.split("?")[0];window.location=t+"?page=better-payment-transactions"})),e(document).on("click",".better-payment-admin-transactions-page .delete-button",(function(t){t.preventDefault();let a=e(this).attr("data-id"),n=e(this).closest(".table__row"),s=betterPaymentObj.nonce,o=betterPaymentObj.alerts.confirm,r=betterPaymentObj.alerts.confirm_description,i=betterPaymentObj.alerts.yes,l=betterPaymentObj.alerts.no,c=(betterPaymentObj.messages.no_action_taken,betterPaymentObj.messages.error,betterPaymentObj.messages.success,e(".better-payment .hidden-fields .paged").val()),m=e(".better-payment .per-page").val(),d=e(".better-payment .hidden-fields .total-entry").val();Swal.fire({title:o,text:r,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:`${i}`,cancelButtonText:`${l}`,focusCancel:1}).then((t=>{void 0!==t.value&&1==t.value?e.ajax({type:"POST",url:ajaxurl,data:{action:"better-payment-delete-transaction",nonce:s,id:a,currentPage:c,perPage:m,totalEntryCount:d},success:function(t){t.success?(n.fadeOut("slow"),e(".better-payment .showing-entities-html span").html(t.data.pagination_showing_entities_html),e(".better-payment .hidden-fields .total-entry").val(d-1),toastr.success(t.data.message)):toastr.error(t.data.message)}}):"cancel"==t.dismiss||t.dismiss}))})),e(document).on("click",".better-payment-transaction-filter",(function(t){t.preventDefault();let a=e(".better-payment input[name='payment_date_from']").val(),n=e(".better-payment input[name='payment_date_to']").val();if(""!=a&&""!=n&&a>n)return toastr.error("From Date must be smaller than To Date!"),!1;let s=e(".better-payment-admin-transactions-page .transaction__table"),o={};o.search_text=e(".better-payment .serch-text").val(),o.payment_date_from=a,o.payment_date_to=n,o.order_by=e(".better-payment input[name='order_by[]']:checked").val(),o.order=e(".better-payment input[name='order[]']:checked").val(),o.status=e(".better-payment input[name='status[]']:checked").val(),o.source=e(".better-payment input[name='source[]']:checked").val(),o.paged=e(".better-payment .paged").val(),o.per_page=e(".better-payment .per-page").val(),o.total_entry=e(".better-payment .total-entry").val(),function(t,a){e.ajax({type:"POST",url:ajaxurl,data:{action:"better-payment-filter-transaction",nonce:betterPaymentObj.nonce,filterFormData:a},dataType:"html",beforeSend:function(){t.css("opacity",".5")},success:function(a){e(".better-payment .transaction-table-wrapper").replaceWith(a),t.css("opacity","1")}})}(s,o)}));let t=document.getElementsByClassName("bp-copy-clipboard");function a(){let t="bp_copy_clipboard_input_"+e(this).attr("data-bp_txn_counter");if(t=document.getElementById(t),document.body.createTextRange){const e=document.body.createTextRange();e.moveToElementText(t),e.select(),document.execCommand("copy")}else if(window.getSelection){const e=window.getSelection(),a=document.createRange();a.selectNodeContents(t),e.removeAllRanges(),e.addRange(a),document.execCommand("copy"),e.removeAllRanges()}else console.warn("Could not select text in node: Unsupported browser.");e(".bp-copy-clipboard").attr("title","Copy").css("color","#2a3256"),e(this).attr("title","Copied!").css("color","#6e58f7")}Array.from(t).forEach((function(e){e.addEventListener("click",a)}));let n=document.getElementsByClassName("bp-email-copy-clipboard");function s(){let t="bp_email_copy_clipboard_input_"+e(this).attr("data-bp_txn_counter");if(t=document.getElementById(t),document.body.createTextRange){const e=document.body.createTextRange();e.moveToElementText(t),e.select(),document.execCommand("copy")}else if(window.getSelection){const e=window.getSelection(),a=document.createRange();a.selectNodeContents(t),e.removeAllRanges(),e.addRange(a),document.execCommand("copy"),e.removeAllRanges()}else console.warn("Could not select text in node: Unsupported browser.");e(".bp-email-copy-clipboard").attr("title","Copy").css("color","#2a3256"),e(this).attr("title","Copied!").css("color","#6e58f7")}function o(e){return(e.charAt(0).toUpperCase()+e.slice(1)).replace("_"," ")}function r(t,a="status",n=""){e(`.${a}-button-text`).html(n+o(t))}Array.from(n).forEach((function(e){e.addEventListener("click",s)})),e(document).on("click",".better-payment .bp_time_period-custom-range",(function(t){e(".better-payment .modal.bp-custom-time-period").addClass("is-active")})),e(document).on("click",".bp-select-custom-button",(function(t){t.preventDefault();let a=e(this).attr("data-target");e(a).toggleClass("is-hidden"),function(t,a){let n=a.replace(".","").replace("-dropdown","");t.length>0&&t.forEach((function(t){t!==n&&(e(`.${t}-dropdown`).hasClass("is-hidden")||e(`.${t}-dropdown`).addClass("is-hidden"))}))}(["status","order_by","order","source"],a)})),e(document).on("click","body",(function(t){!function(t=["status","source"],a,n="bp-select-custom-button-wrap"){let s=e(`.${n}`);s.is(a.target)||0!==s.has(a.target).length||t.length>0&&t.forEach((function(t){e(`.${t}-dropdown`).hasClass("is-hidden")||e(`.${t}-dropdown`).addClass("is-hidden")}))}(["status","order_by","order","source"],t)})),e(".bp-select-custom-button-dropdown input[type='checkbox']").change((function(){let t=e(this).attr("name");t=t.replace("[]","");let a=e(this).closest(".bp-select-custom-button-dropdown").attr("data-defaultvalue");this.checked?(e(`.${t}-dropdown input[name='${t}[]']`).not(this).prop("checked",!1),r(this.value,t)):e(`.${t}-dropdown input[name='${t}[]']:checked`).length||(void 0!==a&&e(`.${t}-dropdown .${t}-${a}`).prop("checked",!0),r(o(t),t))})),e("#better-payment-admin-settings-form .serch-text").keypress((function(t){if(13==t.which)return e(".better-payment-transaction-filter").trigger("click"),!1})),e(document).on("click",".better-payment-transaction-import",(function(t){e(".better-payment-transaction-import-wrap").toggleClass("is-hidden",1e3)})),e(document).on("change",".better-payment-transaction-import-input",(function(t){let a=e("input[name=better-payment-transaction-import-input]")[0].files.length?e("input[name=better-payment-transaction-import-input]").val().split("\\").pop():"No file choosen";e(".better-payment-transaction-import-wrap .file-name").text(a)})),e(document).on("click",".better-payment-transaction-import-button",(function(t){let a=e("input[name=better-payment-transaction-import-input]").val();if(!a)return toastr.error("No file selected!"),!1;let n=function(e){let t=["csv"],a=e.split(".").pop().toLowerCase();for(let e=0;e<t.length;e++)if(t[e]==a)return!0;return!1}(a);return n?void 0:(toastr.error("Invalid file type!"),!1)})),e(document).on("click",".better-payment-transaction-export",(function(t){e(".better-payment .better-payment-transaction-export").text("Exporting..."),e.ajax({type:"POST",url:ajaxurl,data:{action:"better-payment-transactions-export",nonce:betterPaymentObj.nonce},success:function(t){var a=document.createElement("a"),n=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(n);a.href=s,a.download="better_payment_transactions.csv",document.body.appendChild(a),a.click(),document.body.removeChild(a),e(".better-payment .better-payment-transaction-export").text("Export All")}})})),toastr.options={timeOut:"2000",toastClass:"font-size-md",positionClass:"toast-top-center",showMethod:"slideDown",hideMethod:"slideUp"},e(".bp-datepicker").datepicker({dateFormat:"dd-mm-yy"})}))})();